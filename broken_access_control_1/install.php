<?php

// Request khởi tạo database.
if (isset($_REQUEST["install.php"])) {
}
include("variable.php");
// Ket noi database
$link = new mysqli($db_server, $db_username, $db_password);

if ($link->connect_error) {
    die("Error fail: " . $link->connect_error);
}
// Kiem tra database ton tai
$result = $link->query("SHOW DATABASES LIKE '$db_name'");
// Kiem tra database ton tai
if ($result->num_rows == 0) {
    // echo "Khởi tạo database thành công.";
    // Tao database
    $sql = "CREATE DATABASE IF NOT EXISTS " . $db_name;
    $recordset = $link->query($sql);

    if (!$recordset) {

        die("Error: " . $link->error);
    }

    // Chon database
    mysqli_select_db($link, $db_name);

    // Tao bang users
    $sql = "CREATE TABLE users (
        id INT AUTO_INCREMENT PRIMARY KEY,
        username VARCHAR(255) NOT NULL,
        password VARCHAR(255) NOT NULL
    );";
    $recordset = $link->query($sql);
    if (!$recordset) {

        die("Error: " . $link->error);
    }


    $userData = array(
        array('ThanhAT179PTIT','ptit@123'),
        array('HuyPTIT','ptit@123'),
        array('LongPTIT','ptit@123'),
        array('HieuPTIT','ptit@123'),
        array('DatPTIT','ptit@123'),
        array('KhaiPTIT','ptit@123'),
    );


    // Chuẩn bị câu lệnh SQL INSERT
    $sql = "INSERT INTO users (username, password) VALUES ";

    // Lặp qua mảng dữ liệu người dùng và thêm vào câu lệnh SQL
    foreach ($userData as $user) {
        $sql .= "('" . $user[0] . "', '" . $user[1] . "'),";
    }

    // Loại bỏ dấu phẩy cuối cùng
    $sql = rtrim($sql, ',');
    $recordset = $link->query($sql);
    if (!$recordset) {

        die("Error: " . $link->error);
    }



} else {
    // echo "Database đã tồn tại.";
}
